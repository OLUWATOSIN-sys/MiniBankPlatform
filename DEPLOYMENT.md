# ğŸš€ Deployment Guide - MiniBank Platform

This guide explains how to deploy your MiniBank platform to production using Render (backend) and Vercel (frontend).

## ğŸ“‹ **Prerequisites**

- GitHub repository: `git@github.com:OLUWATOSIN-sys/MiniBankPlatform.git`
- Render account (free tier)
- Vercel account (free tier)

## ğŸ—ï¸ **Architecture**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Vercel        â”‚    â”‚   Render        â”‚    â”‚   Render        â”‚
â”‚   (Frontend)    â”‚â”€â”€â”€â–¶â”‚   (Backend)     â”‚â”€â”€â”€â–¶â”‚   (PostgreSQL)  â”‚
â”‚   Next.js       â”‚    â”‚   NestJS        â”‚    â”‚   Database      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ **Step 1: Push to GitHub**

```bash
# Initialize git if not already done
git init
git remote add origin git@github.com:OLUWATOSIN-sys/MiniBankPlatform.git

# Add all files
git add .
git commit -m "Initial commit: MiniBank Platform with PostgreSQL"
git push -u origin main
```

## ğŸ¯ **Step 2: Deploy Backend to Render**

### 2.1 **Create New Web Service**

1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click **"New"** â†’ **"Web Service"**
3. Connect your GitHub repository: `OLUWATOSIN-sys/MiniBankPlatform`

### 2.2 **Configure Web Service**

```yaml
Name: minibank-backend
Runtime: Node
Build Command: cd backend && npm install && npm run build
Start Command: cd backend && npm run start:prod
```

### 2.3 **Environment Variables**

Add these in Render dashboard:

```env
NODE_ENV=production
PORT=10000
JWT_SECRET=your-super-secure-jwt-secret-here
JWT_EXPIRATION=24h
USD_TO_EUR_RATE=0.92
FRONTEND_URL=https://mini-bank-platform.vercel.app
```

### 2.4 **Create PostgreSQL Database**

1. In Render dashboard: **"New"** â†’ **"PostgreSQL"**
2. Name: `minibank-postgres`
3. Database Name: `minibank`
4. User: `minibank`
5. Plan: **Free**

### 2.5 **Connect Database to Backend**

1. Go to your web service settings
2. Add environment variable:
   ```
   DATABASE_URL = [Copy from PostgreSQL dashboard - Internal Database URL]
   ```

## ğŸŒ **Step 3: Deploy Frontend to Vercel**

### 3.1 **Connect Repository**

1. Go to [Vercel Dashboard](https://vercel.com/dashboard)
2. Click **"Add New"** â†’ **"Project"**
3. Import `OLUWATOSIN-sys/MiniBankPlatform`

### 3.2 **Configure Project**

```yaml
Framework Preset: Next.js
Root Directory: frontend
Build Command: npm run build
Output Directory: .next (default)
Install Command: npm install
```

### 3.3 **Environment Variables**

Add in Vercel project settings:

```env
NEXT_PUBLIC_API_URL=https://minibank-backend.onrender.com
```

### 3.4 **Domain Settings**

- Vercel will auto-generate: `mini-bank-platform.vercel.app`
- You can customize the domain in project settings

## ğŸš€ **Step 4: Auto-Deployment Setup**

Both services are now configured for **automatic deployment**:

### âœ… **Push to Deploy**
```bash
git add .
git commit -m "Update feature"
git push origin main
```

**What happens automatically:**
1. ğŸ”„ GitHub webhook triggers deployment
2. ğŸ—ï¸ Render builds and deploys backend
3. ğŸŒ Vercel builds and deploys frontend
4. âœ… Both services update with zero downtime

## ğŸ“Š **Step 5: Verification**

### 5.1 **Test Backend**
```bash
curl https://minibank-backend.onrender.com
# Should return: {"message": "MiniBank API is running!"}

curl https://minibank-backend.onrender.com/api
# Should show Swagger documentation
```

### 5.2 **Test Frontend**
Visit: `https://mini-bank-platform.vercel.app`

Expected:
- âœ… Login page loads
- âœ… Can register new account
- âœ… Dashboard shows balances
- âœ… Transfers work between users
- âœ… Currency exchange works

### 5.3 **Test Database**
```bash
# Check database connection
curl -X POST https://minibank-backend.onrender.com/auth/register \\
  -H "Content-Type: application/json" \\
  -d '{
    "email": "test@example.com",
    "password": "password123",
    "firstName": "Test",
    "lastName": "User"
  }'
```

## ğŸ”’ **Step 6: Security Configuration**

### 6.1 **Environment Variables Security**

**âœ… Secure (in Render/Vercel dashboard):**
- `JWT_SECRET` - Auto-generated by Render
- `DATABASE_URL` - Auto-injected by Render

**âš ï¸ Never commit:**
- Production passwords
- API keys
- Database credentials

### 6.2 **CORS Configuration**

Backend automatically allows:
- `https://mini-bank-platform.vercel.app`
- Custom domains you add to Vercel

## ğŸ“ˆ **Step 7: Monitoring**

### 7.1 **Render Monitoring**
- View logs: Render dashboard â†’ Your service â†’ Logs
- Monitor performance: Built-in metrics
- Set up alerts: Available in paid plans

### 7.2 **Vercel Monitoring**
- Analytics: Vercel dashboard â†’ Analytics
- Function logs: Functions tab
- Performance insights: Built-in

## ğŸ”„ **Step 8: Updates & Maintenance**

### 8.1 **Code Updates**
```bash
# Make changes
git add .
git commit -m "Feature: Add new banking feature"
git push origin main
# âœ… Auto-deploys to both services
```

### 8.2 **Database Migrations**
```bash
# For schema changes, add migration
npm run migration:generate -- -n AddNewFeature
# Push to trigger deployment with migration
```

### 8.3 **Rollback**
```bash
# Revert to previous commit
git revert HEAD
git push origin main
# âœ… Auto-deploys previous version
```

## ğŸ“ **Troubleshooting**

### Backend Issues
1. **Check Render logs**: Dashboard â†’ Service â†’ Logs
2. **Database connection**: Verify `DATABASE_URL` is set
3. **Environment vars**: Ensure all required vars are set

### Frontend Issues  
1. **Check Vercel logs**: Dashboard â†’ Functions â†’ View Function Logs
2. **API connection**: Verify `NEXT_PUBLIC_API_URL` points to Render
3. **Build errors**: Check build logs in deployment tab

### Database Issues
1. **Connection**: Test DATABASE_URL connection
2. **Migrations**: Ensure migrations ran successfully  
3. **Seeds**: Check if initial data was created

## ğŸ‰ **Success!**

Your MiniBank platform is now:
- âœ… **Live in production**
- âœ… **Auto-deploying** on every push
- âœ… **Fully scalable** on cloud infrastructure
- âœ… **Monitored** with built-in analytics
- âœ… **Secure** with proper environment variables

## ğŸ”— **Production URLs**

- **Frontend**: https://mini-bank-platform.vercel.app
- **Backend**: https://minibank-backend.onrender.com  
- **API Docs**: https://minibank-backend.onrender.com/api
- **Database**: Managed PostgreSQL on Render

**Total Setup Time**: ~15 minutes
**Cost**: $0 (Free tiers for both services)
